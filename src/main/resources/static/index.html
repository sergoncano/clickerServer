<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Hello, world!</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="description" content="" />
    <link rel="icon" href="favicon.png" />
  </head>

  <body>
    <textarea
      rows="1"
      cols="36"
      placeholder="User login token"
      id="login-textarea"
    ></textarea>
    <button type="button" onclick="login()">Login</button>
    <br />
    <textarea
      rows="1"
      cols="10"
      placeholder="Username"
      id="register-textarea"
    ></textarea>
    <button type="button" onclick="register()">Register</button>
  </body>
  <script>
    function login() {
      let token = document.getElementById("login-textarea").value;
      let response = fetch("http://localhost:8080/api/authentication/login", {
        method: "POST",
        body: token,
        headers: {
          "Content-type": "text/plain; charset=UTF-8",
        },
      })
        .then((response) => {
          alert(response.data.message);
        })
        .catch((error) => {
          console.error("error:", error);
        });
    }

    function register() {
      let username = document.getElementById("register-textarea").value;
      let uuid = fetch("http://localhost:8080/api/authentication/register", {
        method: "POST",
        body: username,
        headers: {
          "Content-type": "text/plain; charset=UTF-8",
        },
      })
        .then((response) => {
          if (!response.ok) {
            if (response.status === 403) {
              // Handle forbidden access
              return response.json().then((errorData) => {
                throw new Error(errorData.message || "Access denied");
              });
            }
            throw new Error("Network response was not ok");
          }
          return response.json();
        })
        .then((data) => {
          // Process successful response
          console.log("Access granted:", data);
        })
        .catch((error) => {
          console.error("error:", error);
        });
    }
  </script>
</html>
